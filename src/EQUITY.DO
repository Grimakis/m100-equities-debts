100 REM EQUITIES & DEBTS - TRS-80 M100 VERSION
300 REM Optimized for 32KB RAM, 40-column display
400 DIM PS$(4),P%(4,10),C!(4),SN$(10),FN$(10),SP%(10),PL%(10),DI%(10)
500 DIM DV%(10),PH%(10,10),SX%(10),SZ%(10)
600 DIM CC%(11,8),CD%(11),US%(36),CU%
800 DIM BK%(4)
900 PN%=0:YR%=0:MK%=0:DI%=0:I%=0:S%=0:ST%=0:SH%=0:TN%=0:DM%=1:OV%=0:CL%=0:SS%=0:IR%=0
1000 CS!=0:RV!=0:TT!=0:CH%=0
1100 GOSUB 1300
1200 END
1300 CLS:REM MAIN GAME INIT
1400 PRINT "EQUITIES & DEBTS"
1500 PRINT "TRS-80 Model 100"
1600 PRINT ""
1700 PRINT "Players(1-4)";:INPUT PN%
1800 IF PN%<1 OR PN%>4 THEN PRINT "Invalid":GOTO 1700
1900 CLS:PRINT ""
2000 PRINT "Dice Mode:"
2010 PRINT "1: Standard"
2020 PRINT "2: Year-One Individual"
2030 PRINT "3: All Individual"
2040 PRINT "Choose (1-3)";:K$=""
2050 K$=INKEY$
2060 IF K$="" THEN GOTO 2050
2070 IF K$="1" THEN DM%=1:GOTO 2600
2080 IF K$="2" THEN DM%=2:GOTO 2600
2090 IF K$="3" THEN DM%=3:GOTO 2600
2100 IF K$=CHR$(27) THEN GOTO 1700
2110 GOTO 2050
2600 PRINT ""
2700 FOR I%=1 TO PN%
2800 PRINT "Name";:INPUT PS$(I%)
2900 NEXT I%
3000 GOSUB 45000:REM INIT STOCKS
3100 GOSUB 4700:REM INIT PLAYERS
3200 GOSUB 43100:REM SEED RNG
3300 GOSUB 26000:REM SELECT & LOAD CHANCE CARDS
3320 YR%=1:CL%=0
3340 CLS:PRINT "===== YEAR";YR%;"OF 10 ====="
3360 GOSUB 31700:REM BANKRUPTCY RECOVERY
3380 GOSUB 5500:GOSUB 5700:REM DETERMINE MARKET & SET PRICES
3420 GOSUB 32300:REM CHECK FOR BANKRUPTCIES
3440 GOSUB 33900:REM CHECK PLAYER BANKRUPTCIES
3460 GOSUB 11800:REM TRADING PHASE (each player)
3480 GOSUB 19400:REM SHOW SCORES (end of year)
3500 FOR YR%=2 TO 10
3520 GOSUB 30100:REM PAY DIVIDENDS
3540 CLS:PRINT "===== YEAR";YR%;"OF 10 ====="
3560 GOSUB 31700:REM BANKRUPTCY RECOVERY
3580 GOSUB 5500:GOSUB 5700:REM DETERMINE MARKET & SET PRICES
3620 GOSUB 32300:REM CHECK FOR BANKRUPTCIES
3640 GOSUB 33900:REM CHECK PLAYER BANKRUPTCIES
3660 GOSUB 11800:REM TRADING PHASE (each player)
3680 GOSUB 19400:REM SHOW SCORES (end of year)
3700 NEXT YR%
3720 CL%=1:YR%=10:REM CLOSE (NO TRADING/DIVIDENDS)
3740 GOSUB 31700:REM BANKRUPTCY RECOVERY
3760 GOSUB 5500:GOSUB 5700:REM DETERMINE MARKET & SET PRICES
3800 GOSUB 32300:REM CHECK FOR BANKRUPTCIES
3820 GOSUB 33900:REM CHECK PLAYER BANKRUPTCIES
3840 GOSUB 20200:REM FINAL RESULTS AT CLOSING PRICES
3860 RETURN
4700 FOR I%=1 TO PN%:REM INIT PLAYERS
4800 C!(I%)=5000
4900 FOR S%=1 TO 10
5000 P%(I%,S%)=0
5100 NEXT S%
5200 NEXT I%
5300 FOR I%=1 TO PN%:BK%(I%)=0:NEXT I%
5400 RETURN
5500 MK%=INT(RND(1)*2):REM DETERMINE MARKET
5600 RETURN
5700 CLS:REM SET PRICES
5800 CALL 16959
5850 IF YR%=1 AND CL%=0 THEN IR%=1 ELSE IR%=0
5860 OV%=0
5870 IF DM%=1 THEN GOTO 6900
5880 IF DM%=2 AND IR%=0 THEN GOTO 6900
5890 GOTO 6000
6000 FOR S%=2 TO 10:REM INDIVIDUAL DICE MODE
6020 DI%(S%)=(INT(RND(1)*6)+1)+(INT(RND(1)*6)+1)
6030 NEXT S%
6040 IF DM%<>3 THEN GOTO 7100
6050 FOR S%=2 TO 10
6060 IF DI%(S%)=2 THEN OV%=2:GOTO 6090
6070 IF DI%(S%)=12 THEN OV%=12
6080 NEXT S%
6090 IF OV%>0 THEN FOR S%=2 TO 10:DI%(S%)=OV%:NEXT S%
6100 GOTO 7100
6900 DI%=(INT(RND(1)*6)+1)+(INT(RND(1)*6)+1)
6910 GOTO 7100
7100 FOR S%=1 TO 10:SX%(S%)=0:PL%(S%)=SP%(S%):NEXT S%
7200 GOSUB 8600
7300 GOSUB 28200:REM APPLY CHANCE CARD
7400 IF CL%=0 THEN FOR S%=1 TO 10:PH%(S%,YR%)=SP%(S%):NEXT S%
7500 FOR S%=1 TO 10
7600 IF SP%(S%)>=150 THEN SZ%(S%)=SP%(S%):SX%(S%)=1:GOSUB 10200
7700 NEXT S%
7800 YY%=YR%
7900 IF CL%=1 THEN PRINT "===== CLOSE =====" ELSE PRINT "===== YEAR";YR%;"OF 10 ====="
8000 IF CL%=1 THEN PRINT "Close "; ELSE PRINT "Yr";YY%;
8050 D$=""
8060 IF DM%=3 THEN IF OV%>0 THEN D$=STR$(OV%) ELSE D$="IND"
8070 IF D$="" AND DM%=2 AND IR%=1 THEN D$="IND"
8080 IF D$="" THEN D$=STR$(DI%)
8100 IF MK%=0 THEN PRINT "BEAR D:";D$ ELSE PRINT "BULL D:";D$
8200 FOR S%=1 TO 5
8300 GOSUB 11000
8400 NEXT S%
8500 PRINT "Press any key...";:INPUT K$:CALL 16964:RETURN
8600 IF DM%=1 THEN SS%=0:GOSUB 9900:GOTO 9300:REM CALC ALL PRICES
8610 IF DM%=2 AND IR%=0 THEN SS%=0:GOSUB 9900:GOTO 9300:REM CALC ALL PRICES
8620 REM INDIVIDUAL MODE: APPLY PER-STOCK DICE
8630 SS%=1:FOR S%=2 TO 10
8900 DI%=DI%(S%)
9000 IF MK%=0 THEN GOSUB 21100
9100 IF MK%=1 THEN GOSUB 23900
9200 NEXT S%
9300 FOR S%=1 TO 10
9400 IF SP%(S%)<0 THEN SP%(S%)=0
9500 IF SP%(S%)>255 THEN SP%(S%)=255
9700 NEXT S%
9800 RETURN
9900 SS%=0:IF MK%=0 THEN GOSUB 21100:REM NORMAL MODE: SINGLE DICE FOR ALL
10000 IF MK%=1 THEN GOSUB 23900
10100 RETURN
10200 FOR I%=1 TO PN%:REM STOCK SPLIT 2-FOR-1
10300 P%(I%,S%)=P%(I%,S%)*2
10400 NEXT I%
10500 SP%(S%)=INT((SP%(S%)+1)/2)
10600 FOR I%=1 TO YR%
10700 PH%(S%,I%)=INT((PH%(S%,I%)+1)/2)
10800 NEXT I%
10900 RETURN
11000 L$ = SN$(S%) + ":" + STR$(PL%(S%)) + "->":REM DISPLAY PRICE ROW
11100 IF SX%(S%)=1 THEN L$ = L$ + STR$(SZ%(S%)) + "/"
11200 L$ = L$ + STR$(SP%(S%))
11300 R$ = SN$(S%+5) + ":" + STR$(PL%(S%+5)) + "->"
11400 IF SX%(S%+5)=1 THEN R$ = R$ + STR$(SZ%(S%+5)) + "/"
11500 R$ = R$ + STR$(SP%(S%+5))
11600 PRINT L$;TAB(20);R$
11700 RETURN
11800 FOR I%=1 TO PN%:REM TRADING PHASE
11900 GOSUB 12200
12000 NEXT I%
12100 RETURN
12200 CLS:CALL 16959:REM PLAYER TURN
12300 IF BK%(I%)=1 THEN PRINT PS$(I%);" - BANKRUPT":PRINT "Press ENTER";:INPUT Z$:RETURN
12400 GOSUB 13700
12500 PRINT PS$(I%);" Cash:$";INT(C!(I%));" Port:$";INT(TT!)
12600 GOSUB 13300
12700 PRINT@280,"Stock(1-10) 0=Done";:INPUT ST%
12800 IF ST%<0 OR ST%>10 THEN PRINT "Invalid":GOTO 12700
12900 IF ST%=0 THEN CALL 16964:RETURN
13000 GOSUB 15000
13100 CLS:CALL 16959
13200 GOTO 12400
13300 FOR S%=1 TO 5:REM SHOW PRICES
13400 PRINT S%;".";SN$(S%);" $";SP%(S%);TAB(20);S%+5;".";SN$(S%+5);" $";SP%(S%+5)
13500 NEXT S%
13600 RETURN
13700 TT!=C!(I%):REM CALC PORTFOLIO VALUE
13800 FOR S%=1 TO 10
13900 TT!=TT!+P%(I%,S%)*SP%(S%)
14000 NEXT S%
14100 RETURN
14200 QD%=1:REM BUY STOCK
14300 GOSUB 39300
14400 IF SH%=0 THEN RETURN
14500 CS!=SH%*SP%(ST%)
14600 C!(I%)=C!(I%)-CS!
14700 P%(I%,ST%)=P%(I%,ST%)+SH%
14800 PRINT "Bought";SH%;"shares"
14900 RETURN
15000 IF SP%(ST%)<=0 THEN PRINT "BANKRUPT - Cannot trade":RETURN:REM STOCK DETAIL
15100 TN%=0
15200 YY%=YR%
15300 CLS:PRINT FN$(ST%);" Yr";YY%;" $";SP%(ST%)
15400 PRINT "You own:";P%(I%,ST%);" Cash:$";INT(C!(I%))
15500 PRINT ""
15600 PRINT@280,"1=Buy 2=Sell 3=History 0=Back"
15700 K$=INKEY$
15800 IF K$="" THEN GOTO 15700
15900 IF K$="0" THEN TN%=0:GOTO 16400
16000 IF K$="1" THEN TN%=1:GOTO 16400
16100 IF K$="2" THEN TN%=2:GOTO 16400
16200 IF K$="3" THEN TN%=3:GOTO 16400
16300 GOTO 15700
16400 IF TN%=1 THEN GOSUB 14200
16500 IF TN%=2 THEN GOSUB 16900
16600 IF TN%=3 THEN GOSUB 17900
16700 IF TN%<>0 THEN GOTO 15000
16800 RETURN
16900 IF P%(I%,ST%)=0 THEN PRINT "No shares":RETURN:REM SELL STOCK
17000 PRINT "Have";P%(I%,ST%);"shares"
17100 QD%=2
17200 GOSUB 39300
17300 IF SH%=0 THEN RETURN
17400 RV!=SH%*SP%(ST%)
17500 C!(I%)=C!(I%)+RV!
17600 P%(I%,ST%)=P%(I%,ST%)-SH%
17700 PRINT "Sold for $";INT(RV!)
17800 RETURN
17900 CLS:REM HISTORY DISPLAY
18000 PRINT FN$(ST%);" - Price History"
18100 FOR R%=1 TO 5
18200 LY%=R%
18300 RY%=R%+5
18400 LY$=RIGHT$("  "+STR$(LY%),2)
18500 IF LY%<=YR% THEN L$="Yr"+LY$+": $"+STR$(INT(PH%(ST%,LY%))) ELSE L$="Yr"+LY$+": ---"
18600 RY$=RIGHT$("  "+STR$(RY%),2)
18700 IF RY%<=YR% THEN R$="Yr"+RY$+": $"+STR$(INT(PH%(ST%,RY%))) ELSE R$="Yr"+RY$+": ---"
18800 PO%=(R%+1)*40
18900 PRINT@PO%+1,L$;
19000 PRINT@PO%+21,R$;
19100 NEXT R%
19200 PRINT:PRINT "Press ENTER";:INPUT Z$
19300 RETURN
19400 CLS:REM SHOW SCORES
19500 FOR I%=1 TO PN%
19600 GOSUB 13700
19700 IF BK%(I%)=1 THEN PRINT PS$(I%);" BANKRUPT":GOTO 19900
19800 PRINT PS$(I%);" $";INT(TT!)
19900 NEXT I%
20000 PRINT "Press any key...";:INPUT K$
20100 RETURN
20200 CLS:PRINT "==== FINAL RESULTS ====":REM FINAL SCORES
20300 PRINT ""
20400 FOR I%=1 TO PN%
20500 GOSUB 13700
20600 IF BK%(I%)=1 THEN PRINT PS$(I%);" BANKRUPT":GOTO 20800
20700 PRINT PS$(I%);" $";INT(TT!)
20800 NEXT I%
20900 RETURN
21000 REM BEAR MARKET PRICES BY DICE (2-12)
21100 IF DI%<2 THEN DI%=2
21200 IF DI%>12 THEN DI%=12
21300 ON (DI%-1) GOSUB 21600,21700,21800,21900,22000,22100,22200,22300,22400,22500,22550
21400 REM APPLY PRICE CHANGES
21500 IF SS%=0 THEN FOR I%=2 TO 10:READ CH%:SP%(I%)=PL%(I%)+CH%:NEXT I%:RETURN
21510 FOR I%=2 TO S%-1:READ CH%:NEXT I%:READ CH%:SP%(S%)=PL%(S%)+CH%:RETURN
21600 RESTORE 22600:GOSUB 21500:RETURN
21700 RESTORE 22700:GOSUB 21500:RETURN
21800 RESTORE 22800:GOSUB 21500:RETURN
21900 RESTORE 22900:GOSUB 21500:RETURN
22000 RESTORE 23000:GOSUB 21500:RETURN
22100 RESTORE 23100:GOSUB 21500:RETURN
22200 RESTORE 23200:GOSUB 21500:RETURN
22300 RESTORE 23300:GOSUB 21500:RETURN
22400 RESTORE 23400:GOSUB 21500:RETURN
22500 RESTORE 23500:GOSUB 21500:RETURN
22550 RESTORE 23510:GOSUB 21500:RETURN
22600 DATA 12,14,13,10,10,20,21,25,8:REM BEAR: D=2 (CE,GR,ME,PI,SH,ST,TR,UN,UR,VA)
22700 DATA 7,-6,10,-10,-20,6,-19,22,-2:REM BEAR: D=3
22800 DATA 9,10,7,-5,-20,12,21,18,7:REM BEAR: D=4
22900 DATA 7,8,5,-6,40,3,16,-14,4:REM BEAR: D=5 
23000 DATA 8,6,4,-4,-15,8,4,-12,3:REM BEAR: D=6
23100 DATA 6,4,3,3,-15,5,8,-8,5:REM BEAR: D=7
23200 DATA 5,7,-1,-3,45,6,-10,10,4:REM BEAR: D=8
23300 DATA -2,6,-3,-8,-20,7,10,14,6:REM BEAR: D=9
23400 DATA 11,11,-5,-7,30,10,-11,-18,-4:REM BEAR: D=10
23500 DATA -5,13,-8,6,25,4,18,-22,-4:REM BEAR: D=11
23510 DATA -8,-10,-10,-15,-20,-20,-23,-25,-7:REM BEAR: D=12
23600 REM BULL MARKET PRICES
23700 IF DI%<2 THEN DI%=2
23800 IF DI%>12 THEN DI%=12
23900 ON (DI%-1) GOSUB 24000,24100,24200,24300,24400,24500,24600,24700,24800,24900,24950
24000 RESTORE 25000:GOSUB 21500:RETURN
24100 RESTORE 25100:GOSUB 21500:RETURN
24200 RESTORE 25200:GOSUB 21500:RETURN
24300 RESTORE 25300:GOSUB 21500:RETURN
24400 RESTORE 25400:GOSUB 21500:RETURN
24500 RESTORE 25500:GOSUB 21500:RETURN
24600 RESTORE 25600:GOSUB 21500:RETURN
24700 RESTORE 25700:GOSUB 21500:RETURN
24800 RESTORE 25800:GOSUB 21500:RETURN
24900 RESTORE 25900:GOSUB 21500:RETURN
24950 RESTORE 25910:GOSUB 21500:RETURN
25000 DATA -2,-10,-7,-9,-2,21,-7,14,17:REM BULL: D=2
25100 DATA 26,16,25,8,-14,21,14,-4,17:REM BULL: D=3
25200 DATA 18,23,11,12,46,18,-5,34,15:REM BULL: D=4
25300 DATA 23,28,-2,11,56,19,30,29,14:REM BULL: D=5
25400 DATA 20,15,15,7,-20,15,13,-10,12:REM BULL: D=6
25500 DATA 17,21,13,-2,37,23,23,19,14:REM BULL: D=7
25600 DATA 19,24,17,9,-5,26,13,-7,15:REM BULL: D=8
25700 DATA 11,18,14,11,67,15,22,18,13:REM BULL: D=9
25800 DATA 13,31,1,14,-11,18,18,-14,10:REM BULL: D=10
25900 DATA 14,-8,19,-1,-9,25,-10,13,19:REM BULL: D=11
25910 DATA 24,24,23,20,51,27,38,33,18:REM BULL: D=12
26000 FOR I%=1 TO 36:US%(I%)=0:NEXT I%:REM SELECT & LOAD CHANCE CARDS
26020 FOR I%=1 TO 11
26030 R%=INT(RND(1)*36)+1
26040 IF US%(R%)=1 THEN 26030
26050 US%(R%)=1:CD%(I%)=R%
26060 NEXT I%
26070 CU%=1
26080 REM Load the selected cards into CC%
26090 FOR I%=1 TO 11
26100 FOR J%=1 TO 8:CC%(I%,J%)=0:NEXT J%
26110 C%=CD%(I%)
26120 RESTORE 35600
26130 FOR K%=1 TO C%-1
26140 READ D%
26150 IF D%<>0 THEN 26140
26160 NEXT K%
26170 FOR J%=1 TO 8
26180 READ CC%(I%,J%)
26190 IF CC%(I%,J%)=0 THEN J%=8
26200 NEXT J%
26210 NEXT I%
26220 REM FLAVOR TEXT INITIALIZED ABOVE
26230 RETURN
28200 C%=CD%(CU%):REM APPLY CHANCE CARD
28300 GOSUB 44100
28320 CLS
28400 PRINT:PRINT "*** CHANCE CARD #";C%;" ***":PRINT
28500 FOR I%=1 TO 8 STEP 2
28600 SI%=CC%(CU%,I%)
28700 IF SI%=0 THEN GOTO 29620
28800 CH%=CC%(CU%,I%+1)
28900 PRINT SN$(SI%);": ";
29000 IF CH%>0 THEN PRINT "+";
29100 PRINT CH%;" (";SP%(SI%);"-> ";
29200 SP%(SI%)=SP%(SI%)+CH%
29300 IF SP%(SI%)<0 THEN SP%(SI%)=0
29400 IF SP%(SI%)>255 THEN SP%(SI%)=255
29500 PRINT SP%(SI%);")"
29600 NEXT I%
29620 IF C%<>36 OR CL%=1 THEN GOTO 29720
29640 PRINT:PRINT "Extra dividend ($2/share GR):"
29660 FOR PI%=1 TO PN%
29680 IF P%(PI%,2)>0 THEN BD!=P%(PI%,2)*2:C!(PI%)=C!(PI%)+BD!
29690 IF P%(PI%,2)>0 THEN PRINT PS$(PI%);": +$";INT(BD!)
29700 NEXT PI%
29720 PRINT:PRINT "Press ENTER";:INPUT Z$
29740 CLS
29800 CU%=CU%+1
29900 RETURN
30100 IF YR%=1 THEN RETURN
30200 CLS:REM PAY DIVIDENDS
30300 PRINT:PRINT "DIVIDENDS":PRINT
30400 FOR PI%=1 TO PN%
30500 DV!=0
30600 FOR SI%=1 TO 10
30700 IF P%(PI%,SI%)>0 AND DV%(SI%)>0 AND SP%(SI%)>=50 THEN DV!=DV!+(P%(PI%,SI%)*SP%(SI%)*DV%(SI%)/100)
30800 NEXT SI%
31100 C!(PI%)=C!(PI%)+DV!
31200 IF DV!>0 THEN PRINT PS$(PI%);": +$";INT(DV!)
31300 NEXT PI%
31500 PRINT:PRINT "Press ENTER";:INPUT Z$
31600 RETURN
31700 BR%=0 : REM --- BANKRUPTCY RECOVERY ---
31800 FOR SI%=1 TO 10
31900 IF SP%(SI%)<=0 THEN SP%(SI%)=100:PRINT SN$(SI%);" recovered!":BR%=1
32000 NEXT SI%
32100 IF BR%=1 THEN PRINT:PRINT "Press ENTER";:INPUT Z$
32200 RETURN
32300 FOR SI%=1 TO 10:REM --- CHECK FOR BANKRUPTCIES ---
32400 IF SP%(SI%)<=0 THEN GOSUB 32700
32500 NEXT SI%
32600 RETURN
32700 SP%(SI%)=0:REM Handle bankruptcy for stock SI%
32800 REM BK% flag removed; bankruptcy handled by price being <=0
32900 CLS
33000 PRINT:PRINT "*** BANKRUPTCY ***"
33100 PRINT SN$(SI%);" - ";FN$(SI%)
33200 PRINT "All shares are worthless!"
33300 FOR PI%=1 TO PN%
33400 P%(PI%,SI%)=0
33500 NEXT PI%
33600 PRINT:PRINT "Press ENTER";:INPUT Z$
33700 CLS
33800 RETURN
33900 BF%=0:REM CHECK PLAYER BANKRUPTCIES
34000 FOR PI%=1 TO PN%
34100 IF BK%(PI%)=1 THEN GOTO 35300
34200 NW!=C!(PI%)
34300 FOR SI%=1 TO 10
34400 NW!=NW!+(P%(PI%,SI%)*SP%(SI%))
34500 NEXT SI%
34600 IF NW!>0 THEN GOTO 35300
34700 IF BF%=0 THEN CLS:PRINT:PRINT "*** PLAYER BANKRUPTCY ***":PRINT:BF%=1
34800 PRINT PS$(PI%);" is BANKRUPT!"
34900 PRINT "Net worth: $";INT(NW!)
35000 C!(PI%)=0
35100 FOR SI%=1 TO 10:P%(PI%,SI%)=0:NEXT SI%
35200 BK%(PI%)=1
35300 NEXT PI%
35400 IF BF%=1 THEN PRINT:PRINT "Press ENTER";:INPUT Z$
35500 RETURN
35600 DATA 6,17,0  : REM Card 1: ST +17 REM --- CHANCE CARDS DATA (36 CARDS) ---
35700 DATA 7,-5,0  : REM Card 2: TR -5
35800 DATA 7,10,0  : REM Card 3: TR +10
35900 DATA 4,3,10,4,0  : REM Card 4: PI +3, VA +4
36000 DATA 9,10,0  : REM Card 5: UR +10
36100 DATA 9,10,0  : REM Card 6: UR +10
36200 DATA 3,5,0  : REM Card 7: ME +5
36300 DATA 7,5,0  : REM Card 8: TR +5
36400 DATA 2,-8,3,-5,8,-7,0  : REM Card 9: GR -8, ME -5, UN -7
36500 DATA 8,-5,0  : REM Card 10: UN -5
36600 DATA 3,10,0  : REM Card 11: ME +10
36700 DATA 8,10,0  : REM Card 12: UN +10
36800 DATA 8,-15,0  : REM Card 13: UN -15
36900 DATA 2,8,3,5,4,5,8,7,0  : REM Card 14: GR +8, ME +5, PI +5, UN +7
37000 DATA 7,15,0  : REM Card 15: TR +15
37100 DATA 10,5,0  : REM Card 16: VA +5
37200 DATA 8,-15,0  : REM Card 17: UN -15
37300 DATA 8,10,0  : REM Card 18: UN +10
37400 DATA 8,15,0  : REM Card 19: UN +15
37500 DATA 9,-25,0  : REM Card 20: UR -25
37600 DATA 2,8,0  : REM Card 21: GR +8
37700 DATA 10,-14,0  : REM Card 22: VA -14
37800 DATA 5,-5,0  : REM Card 23: SH -5
37900 DATA 2,-10,0  : REM Card 24: GR -10
38000 DATA 5,5,0  : REM Card 25: SH +5
38100 DATA 6,-10,0  : REM Card 26: ST -10
38200 DATA 3,-10,0  : REM Card 27: ME -10
38300 DATA 6,-15,0  : REM Card 28: ST -15
38400 DATA 7,-25,0  : REM Card 29: TR -25
38500 DATA 3,-5,0  : REM Card 30: ME -5
38600 DATA 2,10,0  : REM Card 31: GR +10
38700 DATA 2,-8,0  : REM Card 32: GR -8
38800 DATA 4,-8,6,8,9,5,0  : REM Card 33: PI -8, ST +8, UR +5
38900 DATA 10,5,0  : REM Card 34: VA +5
39000 DATA 2,-10,0  : REM Card 35: GR -10
39100 DATA 2,10,0  : REM Card 36: GR +10 (special: also pays $2/share dividend)
39200 REM CHANCE CARD FLAVOR TEXT
39300 PR%=SP%(ST%):REM QUANTITY DIAL UI
39400 CA!=C!(I%)
39500 OW%=P%(I%,ST%)
39600 IF QD%=1 THEN GOTO 39800
39700 MX%=INT(OW%/10)*10:GOTO 40000
39800 IF PR%<=0 THEN MX%=0 ELSE MX%=INT(CA!/PR%/10)*10
39900 GOTO 40000
40000 IF MX%<=0 THEN 40200
40100 GOTO 40700
40200 CLS
40300 IF QD%=1 THEN PRINT "Can't afford 10 shares of ";FN$(ST%); ELSE PRINT "No shares to sell for ";FN$(ST%);
40400 PRINT "Press ENTER";:INPUT KY$
40500 SH%=0
40600 RETURN
40700 CLS
40800 HM$="BUY "
40900 IF QD%=2 THEN HM$="SELL "
41000 PRINT@0,HM$;FN$(ST%);" Yr";YR%;" $";SP%(ST%)
41100 PRINT@40,"Cash $";INT(CA!);"  Own ";OW%
41200 PRINT@120,"Shares:"
41300 PRINT@160,"Total: $"
41400 PRINT@200,"After: $"
41500 PRINT@280,"W:+10  S:-10  ENTER=OK  Q=Cancel"
41600 SH%=0
41700 TC!=SH%*PR%
41800 IF QD%=1 THEN AF!=CA!-TC! ELSE AF!=CA!+TC!
41900 PRINT@128,RIGHT$("     "+MID$(STR$(SH%),2),5)
42000 PRINT@168,RIGHT$("     "+MID$(STR$(INT(TC!)),2),5)
42100 PRINT@208,RIGHT$("     "+MID$(STR$(INT(AF!)),2),5)
42200 KY$=INKEY$
42300 IF KY$="" THEN 41700
42400 IF KY$="W" OR KY$="w" OR KY$="+" THEN SH%=SH%+10:GOTO 42800
42500 IF KY$="S" OR KY$="s" OR KY$="-" THEN SH%=SH%-10:GOTO 42800
42600 IF KY$=CHR$(13) THEN RETURN
42700 IF KY$="Q" OR KY$="q" THEN SH%=0:RETURN
42800 IF SH%<0 THEN SH%=0
42900 IF SH%>MX% THEN SH%=MX%
43000 GOTO 41700
43100 H%=VAL(LEFT$(TIME$,2)):REM SEED RNG FROM TIME$
43200 M%=VAL(MID$(TIME$,4,2))
43300 S%=VAL(RIGHT$(TIME$,2))
43400 SD!=H%*3600!+M%*60!+S%
43500 IF SD!<1 THEN SD!=1
43600 SR%=INT(SD!-31*INT(SD!/31))
43700 FOR I%=1 TO SR%+5
43800 U!=RND(1)
43900 NEXT I%
44000 RETURN
44100 CLS:REM SHOW CHANCE CARD FLAVOR TEXT
44200 PRINT "CHANCE CARD #";C%
44300 PRINT
44400 RESTORE 45000
44500 FOR T%=1 TO C%:READ A$:NEXT T%
44600 PRINT A$
44700 PRINT
44800 PRINT@280,"Press any key";
44900 NA$=INKEY$
44910 IF NA$="" THEN 44900
44920 A$="":RETURN
45000 DATA "Oil firm bids cash; board backs sale"
45100 DATA "President hospitalized; leave unknown"
45200 DATA "Ad blitz wins 3 major long contracts"
45300 DATA "Buying wave lifts broad market"
45400 DATA "Prospectors strike rich new ore field"
45500 DATA "Test nuclear plant beats cost forecasts"
45600 DATA "National tenant leases top office tower"
45700 DATA "Company relocates to prime site"
45800 DATA "Profit-taking wave pushes market down"
45900 DATA "Rival debuts low-cost auto gearbox"
46000 DATA "City eyes best tract for big fair"
46100 DATA "National Auto unveils new mini-car"
46200 DATA "Strikes shut 8 National Auto plants"
46300 DATA "Market rises steadily for 2 months"
46400 DATA "Company wins 10-year supply contract"
46500 DATA "Coal prices cut for power utilities"
46600 DATA "Import-car craze slows big-car sales"
46700 DATA "Three-for-one split rumor spreads"
46800 DATA "Expansion plan: capacity up 30 percent"
46900 DATA "Govt ends ore price supports; glut"
47000 DATA "Strong report; $2M set for research"
47100 DATA "Utility board rejects rate hike bid"
47200 DATA "Area declines; rents cut to fill units"
47300 DATA "Upward Incorporated top officers retire"
47400 DATA "New jobs nearby spark housing shortage"
47500 DATA "Land-rights suit delays development"
47600 DATA "City renewal stalled by planners"
47700 DATA "Depletion tax allowance cut 50 percent"
47800 DATA "Terminal fire; insurance falls short"
47900 DATA "Annual report: Q4 earnings weaken"
48000 DATA "Patented metal process touted as key"
48100 DATA "Founder feud; one sells entire stake"
48200 DATA "War scare drives mixed Wall Street"
48300 DATA "Permit granted for larger nuclear unit"
48400 DATA "Antitrust ruling ends product monopoly"
48500 DATA "Board declares extra $2 dividend"
48600 SN$(1)="CY":FN$(1)="County Bonds":DV%(1)=5
48700 SN$(2)="UI":FN$(2)="Upward Incorporated":DV%(2)=1
48800 SN$(3)="CL":FN$(3)="Cityline Properties":DV%(3)=0
48900 SN$(4)="KM":FN$(4)="Keystone Mutual":DV%(4)=4
49000 SN$(5)="SC":FN$(5)="Shadow Creek":DV%(5)=7
49100 SN$(6)="LD":FN$(6)="Longshot Drilling":DV%(6)=0
49200 SN$(7)="CT":FN$(7)="Crosstown Transit":DV%(7)=0
49300 SN$(8)="NA":FN$(8)="National Auto":DV%(8)=2
49400 SN$(9)="YM":FN$(9)="Yellowcake Mining":DV%(9)=6
49500 SN$(10)="SP":FN$(10)="Summit Power":DV%(10)=3
49600 FOR S%=1 TO 10:SP%(S%)=100:PL%(S%)=100:NEXT S%
49700 RETURN
